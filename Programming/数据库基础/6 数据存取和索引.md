## 一  知识结构

#### 1  数据存取

1.1  文件和记录的组织
	1.1.1  文件组织
	1.1.2  记录组织
1.2  数据字典存储
1.3  数据库缓冲区
	1.3.1  缓冲区管理器
	1.3.2  缓冲区替换策略

#### 2  索引

2.1  索引的概念
2.2  顺序索引
	2.2.1  稠密索引和稀疏索引
	2.2.2  多级索引
	2.2.3  辅助索引
	2.2.4  多码索引
2.3  散列索引
	2.3.1  散列函数
	2.3.2  桶溢出
	2.3.3  动态散列
2.4  顺序索引和散列索引的比较
2.5  SQL中的索引

#### 3  B+树索引

3.1  B+树结构
3.2  B+树查询
3.3  B+树更新
	3.3.1  B+树插入
	3.3.2  B+树删除
3.4  不唯一搜索码
3.5  B+树代价分析

## 二  主要内容

​	数据存取是数据库的底层内容，基于计算机的物理结构和具体的操作系统之上。
​	首先考虑如何组织文件和记录。一个数据库被映射到不同的文件，文件中存储数据块的方式可以是定长记录文件也可以是变长记录文件；变长记录文件实现较多，通常的技术是分槽的页结构。记录可以以多种方式存储，多表聚簇文件组织是一种特殊的记录组织形式，它在一个数据块中存储多个关系的相关记录，以优化某些特定查询。
​	数据字典的存储也是数据存取的重要内容，数据库需要考虑存储关系、用户、索引的相关信息。
​	数据库缓冲区管理主存中的数据块，管理部件称为缓冲区管理器。缓冲区管理器负责处理数据块的请求，在必要的时候将数据块调入或移出主存。缓冲区管理器的重要内容是缓冲区替换策略，通常的策略是最近最少用策略，但也可以结合数据库的特性设计更好的策略。

​	索引是在关系的某些属性上建立的用于快速定位记录的数据结构。索引有两种基本类型：顺序索引和散列索引。
​	顺序索引将索引值顺序排列，于是可以使用二分法快速定位对应的索引值。顺序索引又分为稠密索引和稀疏索引。如果索引所占空间仍然过大，那么可以建立多级索引，即索引的索引。辅助索引建立在关系中的元组不按属性值顺序排列的属性上，辅助索引必须是稠密索引。索引可以在单个属性上建立，也可以在多个属性上建立。
​	散列索引可以散列记录也可以散列指针。散列索引需要一个散列函数，散列函数需要有均匀性和随机性，并且容易计算。散列索引有可能桶溢出，一种解决策略是闭散列，具体的策略是溢出桶。为了应对数据库增大的需求，需要使用几种动态散列技术。
​	顺序索引和散列索引各有优劣，具体使用哪种索引取决于很多因素。要衡量不同操作的开销，还要考虑不同类型操作的相对频繁程度。SQL语言可以创建和删除索引，但不是语言标准的一部分。

​	B+树是一种特殊的顺序索引，其优势在于随着数据库的增大，各种操作的开销仍然保持在常数时间。
​	B+树以树结构组织索引。每个节点处可以有若干个键值对，非叶节点处的值指向另一个节点，而叶节点处的值指向对应的记录。B+树是平衡的，每个节点的键值对不能太空也不能太满，以保证B+树的平衡条件。
​	B+树的查询迭代地进行。从根节点向深递归，直到找到一个叶节点，在该叶节点处查询是否存在对应的记录。B+树的更新操作包括插入操作和删除操作，其基本操作和查询操作类似。不同之处在于，如果节点太空或太满，则需要分裂节点或合并节点。分裂节点和合并节点是复杂的操作，从叶节点开始向根节点递归地进行。如果搜索码不唯一，则可能的解决办法是唯一化属性或指针桶。
​	B+树更新的代价是常数时间，实际的时间可能比理论时间更短。

## 三  重点梳理

- 理解文件和记录是如何组织的，理解多表聚簇文件组织。
- 理解数据库缓冲区和缓冲区管理器，理解并掌握缓冲区替换策略。
- 理解并掌握索引，理解并掌握顺序索引和散列索引。
- 理解B+树索引，理解B+树结构，理解并掌握B+树查询、插入、删除操作，理解B+树的特点。

## 四  难点解析

#### 1  分槽的页结构如何组织文件？多表聚簇文件组织如何组织记录？

#### 2  缓冲区替换策略有哪些？如何结合数据库的特性优化缓冲区替换策略？

#### 3  如何构造散列索引？如何散列记录和指针？

#### 4  为什么会出现桶溢出现象？如何解决桶溢出现象？

#### 5  比较顺序索引和散列索引。如何选择索引结构？

#### 6  什么是B+树？B+树的结构是怎样的？如何在B+树中执行查询操作？B+树的特点是什么？

#### 7  如何在B+树中执行插入操作？

#### 8  如何在B+树中执行删除操作？

## 五  重要图表

- **P251  分槽的页结构**
  ![分槽的页结构](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\分槽的页结构.png)
- **P253  多表聚簇文件组织**
  ![多表聚簇文件组织](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\多表聚簇文件组织.png)
- P254  数据字典存储
  ![数据字典存储](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\数据字典存储.png)
- P258  稠密索引和稀疏索引
  ![稠密索引和稀疏索引](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\稠密索引和稀疏索引.png)
- P260  多级索引
  ![多级索引](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\多级索引.png)
- P261  辅助索引
  ![辅助索引](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\辅助索引.png)
- P274  散列索引
  ![散列索引](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\散列索引.png)
- **P262  B+树的叶节点**
  ![B+树的叶节点_1](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\B+树的叶节点_1.png)
  ![B+树的叶节点_2](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\B+树的叶节点_2.png)
- **P263  B+树的结构**
  ![B+树的结构](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\B+树的结构.png)
- **P264  B+树的查询**
  ![B+树的查询](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\B+树的查询.png)
- **P266 & P267  B+树的插入**
  ![B+树的插入](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\B+树的插入.png)
- **P268 & P269  B+树的删除**
  ![B+树的删除](D:\Learn\Note\Programming\数据库基础\Image\6 数据存取和索引\B+树的删除.png)

## 六  薄弱点清单



------

