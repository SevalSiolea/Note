## 一  知识结构

#### 1  SQL概述

#### 2  SQL基本数据定义

2.1  基本数据类型
2.2  模式定义
2.3  完整性约束定义

#### 3  SQL基本查询

3.1  单关系查询
3.2  多关系查询
3.3  查询语句的执行流程
3.4  自然连接

#### 4  查询的有用语法

4.1  重命名
4.2  字符串运算
4.3  所有属性
4.4  排列元组
4.5  `between` 运算符
4.6  集合运算
4.7  空值
	4.7.1  三值逻辑

#### 5  聚集函数

5.1  基本聚集
5.2  分组聚集
5.3  包含聚集的查询流程

#### 6  嵌套查询

6.1  `where` 子查询
6.2  相关子查询
6.3  `from` 子查询
6.4  `with` 子句
6.5  标量子查询

#### 7  插入、更新、删除元组

7.1  插入元组
7.2  更新元组
	7.2.1  `case` 子句
7.3  删除元组

## 二  主要内容

​	SQL是当今主流的关系数据库语言。SQL提供了数据定义语言和数据操纵语言两个部分，并较好地支持完整性约束、视图定义、事务控制、授权等功能，并且还可嵌入到通用编程语言中，响应应用程序和数据库的交互。本章学习SQL的初级语法，但SQL的实现与规范可能有所不同。

​	SQL可用于数据定义。SQL提供了一些基本数据类型，用于定义属性的类型以及值域；常用的有`varchar`和`numeric`。SQL可以定义模式，创建关系模式、更新关系模式、删除关系模式都可以使用SQL轻松完成。在创建关系时还可以定义完整性约束，基本的有主码约束、外码约束、非空约束。

​	SQL支持使用`select-from-where`子句实现查询。可以在单个关系上查询，也可以在多个关系上查询。查询时，先从`from`子句生成笛卡尔积的关系，再从`where`子句过滤元组，最后从`select`子句过滤属性；可以这样理解查询流程，不过实际情况会有优化。为了处理多个关系在某些同名属性上取值相同的普遍情况，SQL支持自然连接。

​	SQL还为查询支持一些有用的语法。可以重命名属性或关系。可以在字符串上施加运算。可以用星号`*`查询所有属性。可以对得到的元组按照某个属性排序。可以在`where`子句中使用`between`运算符。可以在关系上施加集合运算。最后，着重强调了SQL如何在各种情况下处理空值，其中引入了三值逻辑。

​	聚集函数是查询的重要内容。SQL支持五个聚集函数：`avg`，`min`，`max`，`sum`，`count`。可以在整个关系上使用聚集函数，也可以在某个属性上分组后使用聚集函数；使用聚集函数时还可以有`having`子句。引入聚集函数后，查询流程会复杂一些，本章作了重新解释。

​	嵌套查询是SQL查询的重要内容。嵌套查询基于这样的思想：查询的参数和结果都是关系，因此可以将查询语句放置在任何需要一个关系的地方；于是，一个查询可以作为另一个查询的子查询。子查询既可以放置在`where`子句中，也可以放置在`from`子句中。当放置在`where`子句中时，可以进行集合成员检测和集合比较。相关子查询是一类非常重要的子查询，它允许内层查询使用外层查询的相关名称。在`with`子句中使用子查询可以让嵌套查询的结构更加清晰，这种用法有点像使用视图。最后学习了一类特殊的子查询，即标量子查询，返回单个属性的单个元组的子查询可以被放置在任何需要单个值的表达式的地方。

​	最后学习了如何插入、更新和删除元组。分别使用`insert`，`update`，`delete`语句即可。执行操作时，需要先检测所有需要操作的元组再操作元组，否则可能会出现错误。可以用`where`语句过滤需要操作哪些元组。其中，`update`语句提供了`case`子句，以支持在不同条件下的更新操作。

## 三  重点梳理

- 理解SQL语句的主要功能。
- 理解并掌握SQL的基本数据定义。
- 理解并掌握SQL的基本查询，理解查询语句的执行流程。
- 理解并掌握SQL如何支持查询，理解并掌握SQL如何处理空值。
- 理解并掌握SQL如何在查询中使用聚集函数，理解包含聚集的查询流程。
- 理解并掌握嵌套查询，理解并掌握相关子查询。
- 理解并掌握SQL如何插入、更新、删除元组。

## 四  难点解析

#### 1  SQL中如何定义基本的完整性约束？

#### 2  SQL如何执行基本的查询语句？如果加入聚集呢？

#### 3  在SQL查询中如何使用聚集？

#### 4  SQL如何处理空值？

#### 5  SQL如何进行嵌套查询？如何进行相关子查询？如何使用`with`子句？如何进行标量子查询？

## 五  重要图表

无

## 六  薄弱点清单



------

